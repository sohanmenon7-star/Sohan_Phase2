# 2. SSTI 1

> I made a cool website where you can announce whatever you want! Try it out!
I heard templating is a cool and modular way to build web apps! Check out my website here!

## Solution:

- The challenge gives you a link to website which displays the message it is fed. A hint was also given stating, Server Side Template Injection
- From the hint, I understood that I had to research about Server side template injection to solve this challenge
- I searched for common ways to exploit SSTI vulnerabilities, I know had to identify the template used so I could attack it
- The method to identify used some steps, first `${Mathematical operation}`. This did not operate on the function and printed it out as is.
- I the proceeded to the next step, `{{Math operation}}`. This worked on the math operation, meaning it was vulnerable to SSTI.
- Next, `{{7*'7'}}`, depending on the output I would know if the template is Jinga2 or Twig. The output I found was `7777777`, meaning it was Jinga2(Had the output been `49` it would have been Twig)
- Now that I had the template, I just had to figure out a way to get the flag
- I searched online on how to do so and found this line could be run in the entry point
`{{request.application.__globals__.__builtins__.__import__('os').popen('cat flag').read()}}`
- This gave me the flag

## Flag:

```
picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_f5438664}
```

## Concepts learnt:

- While researching about Server Side Template Injection, I learnt a lot about it. I learned about the ways to detect if it is possible to do SSTI, with the most basic step being putting random special characters in it. SSTI vulnerabilities occur in two contexts, code context and plaintext context
- I also learned how to identify the template used by the server and depending on the template, I learned how to exploit them.(Although I primarily only read up on Jinga2 since thats what I was dealing with)

## Notes:

- I read about only the basics of remote command execution, So I think it is possible to obtain such flags in numerous other ways

## Resources:

- https://www.youtube.com/watch?v=iGDJ695dUEM
- https://www.youtube.com/watch?v=-Zea7GB2OwA
- https://www.youtube.com/playlist?list=PLhixgUqwRTjx2BmNF5-GddyqZcizwLLGP
- https://www.youtube.com/playlist?list=PLLKT__MCUeixCoi2jtP2Jj8nZzM4MOzBL
- https://www.google.com
- https://onsecurity.io/article/server-side-template-injection-with-jinja2/
- https://portswigger.net/web-security/server-side-template-injection#how-do-server-side-template-injection-vulnerabilities-arise

## Incorrect Tangents:
- This challenge went pretty smoothly, I only made some errors in the detection of the template, I was confused between Twig and Jinga2
- I also struggled with finding the correct arguments in the remote controlled execution

***
